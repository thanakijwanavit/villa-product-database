---

title: Database Class


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "database.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: database.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>missing environment variable &#39;INVENTORY_BUCKET_NAME&#39; in query NB
dax endpoint missing &#39;DAX_ENDPOINT&#39;
dax endpoint missing &#39;DAX_ENDPOINT&#39;
None
dax endpoint missing &#39;DAX_ENDPOINT&#39;
dax endpoint missing &#39;DAX_ENDPOINT&#39;
None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dax endpoint missing &#39;DAX_ENDPOINT&#39;
None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Main-Database-Class">Main Database Class<a class="anchor-link" href="#Main-Database-Class"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ProductDatabase" class="doc_header"><code>class</code> <code>ProductDatabase</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L58" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ProductDatabase</code>(<strong><code>hash_key</code></strong>:<code>Optional</code>[<code>Any</code>]=<em><code>None</code></em>, <strong><code>range_key</code></strong>:<code>Optional</code>[<code>Any</code>]=<em><code>None</code></em>, <strong><code>_user_instantiated</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong>**<code>attributes</code></strong>:<code>Any</code>) :: <a href="/villaProductDatabase/query.html#Querier"><code>Querier</code></a></p>
</blockquote>
<p>Defines a <code>PynamoDB</code> Model</p>
<p>This model is backed by a table in DynamoDB.
You can create the table by with the <code>create_table</code> method.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Update-with-dictionary">Update with dictionary<a class="anchor-link" href="#Update-with-dictionary"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1">## get original item</span>
<span class="n">item</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">ProductDatabase</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;0000009&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;engname is </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pr_engname&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">### update item</span>
<span class="n">updatedItem</span> <span class="o">=</span> <span class="n">ProductDatabase</span><span class="o">.</span><span class="n">updateWithDict</span><span class="p">(</span><span class="n">item</span><span class="p">,{</span><span class="s1">&#39;pr_engname&#39;</span><span class="p">:</span><span class="s1">&#39;testName&#39;</span><span class="p">})</span>
<span class="k">assert</span> <span class="n">updatedItem</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pr_engname&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;testName&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; name is changed to  </span><span class="si">{</span><span class="n">updatedItem</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pr_engname&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>engname is JOHNNIE WALKER RED 70 CL.
 name is changed to  testName
CPU times: user 4.07 ms, sys: 2 µs, total: 4.07 ms
Wall time: 6.98 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Batch-load-and-save-data">Batch load and save data<a class="anchor-link" href="#Batch-load-and-save-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ProductDatabase</span><span class="o">.</span><span class="n">loadFromCache</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">,</span> <span class="s1">&#39;loadFrom cache not working&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading hashkey allData-hash
loaded hash is 4baf608857ea92134470646a017a6ad910cb2ec7
remote hash is not the same, load remote cache
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;timed exec&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>

<span class="ansi-red-fg">AssertionError</span>: loadFrom cache not working</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dump-database-to-s3">Dump database to s3<a class="anchor-link" href="#Dump-database-to-s3"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ProductDatabase.resetS3Cache()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cacheDb" class="doc_header"><code>cacheDb</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L98" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cacheDb</code>(<strong><code>bucketName</code></strong>=<em><code>None</code></em>, <strong><code>key</code></strong>=<em><code>'allData'</code></em>, <strong><code>limit</code></strong>=<em><code>100</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>cache db to s3 and local efs</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">ProductDatabase</span><span class="o">.</span><span class="n">cacheDb</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading hashkey allData-hash
loaded hash is ce9daae2549a118c30078d6788446e17afc5530d
remote hash is not the same, load remote cache
quering for changes
convert to df
(100, 54)
  cprcode  iprcode  oprcode ordertype               pr_abb pr_active  \
0     NaN  0175853  0175853         Y  GEKKEIKAN KIREI UME         Y   

  pr_cgcode  pr_code pr_dpcode                          pr_engname  ...  \
0        01  0175853        01  GEKKEIKAN KIREI UME COLLAGEN 300ML  ...   

                                       pr_keyword_th  \
0  บรั่นดี,วิสกี้,รัม,เหล้ารัม,จิน,วอดก้า,เตกีล่า...   

                           pr_name_en  \
0  GEKKEIKAN KIREI UME COLLAGEN 300ML   

                                pr_name_th  \
0  GEKKEIKAN คิเรอิ อุเมะ คอลลาเจน 300 ML.   

                    pr_online_name_en  \
0  Gekkeikan Kirei Ume Collagen 300ml   

                         pr_online_name_th sort_weight villa_category_l1_en  \
0  GEKKEIKAN คิเรอิ อุเมะ คอลลาเจน 300 ML.           0          Dry Grocery   

  villa_category_l2_en villa_category_l3_en villa_category_l4_en  
0   Alcohol &amp; Beverage              Liqueur                 Sake  

[1 rows x 55 columns]
hashKey is allData-hash
saving hash to s3
saved hash 0389e66bd5d3529f863327858a17582ee4b87620
saving to remote cache
CPU times: user 1.47 s, sys: 2.52 ms, total: 1.48 s
Wall time: 2.62 s
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cprcode</th>
      <th>iprcode</th>
      <th>oprcode</th>
      <th>ordertype</th>
      <th>pr_abb</th>
      <th>pr_active</th>
      <th>pr_cgcode</th>
      <th>pr_code</th>
      <th>pr_dpcode</th>
      <th>pr_engname</th>
      <th>...</th>
      <th>pr_keyword_th</th>
      <th>pr_name_en</th>
      <th>pr_name_th</th>
      <th>pr_online_name_en</th>
      <th>pr_online_name_th</th>
      <th>sort_weight</th>
      <th>villa_category_l1_en</th>
      <th>villa_category_l2_en</th>
      <th>villa_category_l3_en</th>
      <th>villa_category_l4_en</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0175853</th>
      <td>NaN</td>
      <td>0175853</td>
      <td>0175853</td>
      <td>Y</td>
      <td>GEKKEIKAN KIREI UME</td>
      <td>Y</td>
      <td>01</td>
      <td>0175853</td>
      <td>01</td>
      <td>GEKKEIKAN KIREI UME COLLAGEN 300ML</td>
      <td>...</td>
      <td>บรั่นดี,วิสกี้,รัม,เหล้ารัม,จิน,วอดก้า,เตกีล่า...</td>
      <td>GEKKEIKAN KIREI UME COLLAGEN 300ML</td>
      <td>GEKKEIKAN คิเรอิ อุเมะ คอลลาเจน 300 ML.</td>
      <td>Gekkeikan Kirei Ume Collagen 300ml</td>
      <td>GEKKEIKAN คิเรอิ อุเมะ คอลลาเจน 300 ML.</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Alcohol &amp; Beverage</td>
      <td>Liqueur</td>
      <td>Sake</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 55 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">lambdaAllQueryFeather</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">Response</span><span class="o">.</span><span class="n">fromDict</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">body</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>product-bucket-dev-manual
loading hashkey allData-hash
using url
presign success
loaded hash is 11bb0d00bb3bd1d21e1f99c7dbc7cda050e55937
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cprcode</th>
      <th>iprcode</th>
      <th>oprcode</th>
      <th>ordertype</th>
      <th>pr_abb</th>
      <th>pr_active</th>
      <th>pr_cgcode</th>
      <th>pr_code</th>
      <th>pr_dpcode</th>
      <th>pr_engname</th>
      <th>...</th>
      <th>sort_weight</th>
      <th>villa_category_l1_en</th>
      <th>villa_category_l2_en</th>
      <th>villa_category_l3_en</th>
      <th>villa_category_l4_en</th>
      <th>SaleMode_unit</th>
      <th>ba_nprice</th>
      <th>master_online</th>
      <th>pr_barcode</th>
      <th>pr_barcode2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
      <td>0163956</td>
      <td>0163956</td>
      <td>Y</td>
      <td>ESS.KAJAL PENCIL 19</td>
      <td>Y</td>
      <td>16</td>
      <td>0163956</td>
      <td>19</td>
      <td>ESS.KAJAL PENCIL 19</td>
      <td>...</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Household</td>
      <td>HBA</td>
      <td>Cosmetics</td>
      <td>ITEM</td>
      <td>55.00</td>
      <td>N</td>
      <td>4250338465774</td>
      <td>425033846577</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 55 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@add_class_method</span><span class="p">(</span><span class="n">ProductDatabase</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">dumpToS3</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bucketName</span><span class="o">=</span> <span class="n">INVENTORY_BUCKET_NAME</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;allData&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">cacheDb</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">ProductDatabase</span><span class="o">.</span><span class="n">dumpToS3</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading hashkey allData-hash
loaded hash is 0389e66bd5d3529f863327858a17582ee4b87620
data is still in sync, using local cache
quering for changes
convert to df
(1000, 54)
  cprcode iprcode oprcode ordertype         pr_abb pr_active pr_cgcode  \
0     NaN  239199  239199         Y  BABY FOOD POT         Y        55   

   pr_code pr_dpcode     pr_engname  ...               pr_keyword_th  \
0  0239199      19.0  BABY FOOD POT  ...  Mother&#39;s Corn,เด็ก,ของเด็ก   

      pr_name_en   pr_name_th            pr_online_name_en  \
0  BABY FOOD POT  หม้อด้ามจับ  Mother&#39;s Corn Baby Food Pot   

           pr_online_name_th sort_weight villa_category_l1_en  \
0  Mother&#39;s Corn หม้อด้ามจับ         0.0                 none   

  villa_category_l2_en villa_category_l3_en villa_category_l4_en  
0                 none                 none                 none  

[1 rows x 55 columns]
hashKey is allData-hash
saving hash to s3
saved hash 41db1da8d120d67445cf74c15118b767f8a9d5d8
saving to remote cache
CPU times: user 12.9 s, sys: 0 ns, total: 12.9 s
Wall time: 14.9 s
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cprcode</th>
      <th>iprcode</th>
      <th>oprcode</th>
      <th>ordertype</th>
      <th>pr_abb</th>
      <th>pr_active</th>
      <th>pr_cgcode</th>
      <th>pr_code</th>
      <th>pr_dpcode</th>
      <th>pr_engname</th>
      <th>...</th>
      <th>pr_keyword_th</th>
      <th>pr_name_en</th>
      <th>pr_name_th</th>
      <th>pr_online_name_en</th>
      <th>pr_online_name_th</th>
      <th>sort_weight</th>
      <th>villa_category_l1_en</th>
      <th>villa_category_l2_en</th>
      <th>villa_category_l3_en</th>
      <th>villa_category_l4_en</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>239199</th>
      <td>NaN</td>
      <td>239199</td>
      <td>239199</td>
      <td>Y</td>
      <td>BABY FOOD POT</td>
      <td>Y</td>
      <td>55</td>
      <td>0239199</td>
      <td>19.0</td>
      <td>BABY FOOD POT</td>
      <td>...</td>
      <td>Mother's Corn,เด็ก,ของเด็ก</td>
      <td>BABY FOOD POT</td>
      <td>หม้อด้ามจับ</td>
      <td>Mother's Corn Baby Food Pot</td>
      <td>Mother's Corn หม้อด้ามจับ</td>
      <td>0.0</td>
      <td>none</td>
      <td>none</td>
      <td>none</td>
      <td>none</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 55 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lambdaDumpToS3" class="doc_header"><code>lambdaDumpToS3</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L123" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lambdaDumpToS3</code>(<strong><code>event</code></strong>, <strong><code>_</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">Response</span><span class="o">.</span><span class="n">fromDict</span><span class="p">(</span><span class="n">lambdaDumpToS3</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading hashkey allData-hash
loaded hash is c111d77a566f6529b6e24817eb0fea9c89ae85e8
data is still in sync, using local cache
quering for changes
convert to df
(500, 54)
       iprcode  cprcode  oprcode ordertype                pr_abb pr_active  \
0      0140942  0140942  0140942         Y  FRAGATA OLIVE POMACE         Y   
1      0223750  0223750  0223750         Y  SAMYANG HOT CHICKHEN         Y   
2      0203790  0203790  0203790         Y  KRISTY HAMPER 2016 G         Y   
3      0207006  0207006  0207006         Y   MALEE 100%TANGERINE         Y   
4       235078   235078   235078         Y  PLANEAT ROASTED SEAS         Y   
...        ...      ...      ...       ...                   ...       ...   
88551  0138956  0138956  0138956         Y  BONCHI CORP EBI AGES         Y   
88552   222318   222318   222318         Y  386372 PACK PT FREEE         Y   
88553  0066152  0066152  0066152         Y  NEOS  PACIFICE AROMA         Y   
88554   184290   184290   184290         Y  ALLOWRIE BUTTER SALT         Y   
88555   240882      NaN   240882         Y           TOUCH 20358         Y   

      pr_cgcode  pr_code pr_dpcode                                pr_engname  \
0            01  0140942        08           FRAGATA OLIVE POMACE OIL 2 LITE   
1            04  0223750        03        SAMYANG HOT CHICKHEN CARBONARA130G   
2            45  0203790        19                  KRISTY HAMPER 2016 SET G   
3            03  0207006        20     MALEE 100%TANGERINE SUKHOTHAI 1000 ML   
4            31  0235078      19.0  PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...         ...      ...       ...                                       ...   
88551        17  0138956        19                BONCHI CORP EBI AGESEN 92G   
88552         8   222318      19.0  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553        20  0066152        19                   NEOS  PACIFICE AROMATIC   
88554         1   184290      13.0              ALLOWRIE BUTTER SALTED 10 G.   
88555        08  0240882      19.0                  TOUCH PIZZA CUTTER 20358   

       ...                              hema_name_en  \
0      ...                          Olive Pomace Oil   
1      ...                   Hot Chickhen Carbonarag   
2      ...                  KRISTY HAMPER 2016 SET G   
3      ...                  100% Tangerine Sukhothai   
4      ...  PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...    ...                                       ...   
88551  ...                BONCHI CORP EBI AGESEN 92G   
88552  ...  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553  ...                   NEOS  PACIFICE AROMATIC   
88554  ...              ALLOWRIE BUTTER SALTED 10 G.   
88555  ...                                      none   

                                   hema_name_th  \
0                              Olive Pomace Oil   
1                       Hot Chickhen Carbonarag   
2                      KRISTY HAMPER 2016 SET G   
3                      100% Tangerine Sukhothai   
4      PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...                                         ...   
88551                BONCHI CORP EBI AGESEN 92G   
88552  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553                   NEOS  PACIFICE AROMATIC   
88554              ALLOWRIE BUTTER SALTED 10 G.   
88555                                      none   

                                     pr_name_en  \
0               FRAGATA OLIVE POMACE OIL 2 LITE   
1            SAMYANG HOT CHICKHEN CARBONARA130G   
2                      KRISTY HAMPER 2016 SET G   
3         MALEE 100%TANGERINE SUKHOTHAI 1000 ML   
4      PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...                                         ...   
88551                BONCHI CORP EBI AGESEN 92G   
88552  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553                   NEOS  PACIFICE AROMATIC   
88554              ALLOWRIE BUTTER SALTED 10 G.   
88555                  TOUCH PIZZA CUTTER 20358   

                                         pr_name_th     pr_barcode  \
0       FRAGATA น้ำมันมะกอกธรรมชาติ-กรรมวิธี 2 ลิตร  8410134118601   
1              SAMYANG ฮอตชิคเค่น คาโบนาร่า 130กรัม  8801073113893   
2                          KRISTY HAMPER 2016 SET G       22037909   
3            มาลี น้ำส้มเขียวหวานสุโขทัย100% 1000ML  8853333016383   
4         ปลาณีตปลาข้างเหลืองย่างรส รสพริกไทยดำ45G.           None   
...                                             ...            ...   
88551  BONCHI เอบิ อาเงะเซ็น (ขนมข้าวทอดกรอบรสกุ้ง)  8850358040508   
88552  386372 ชุดกล่องอาหารปลอดสาร BPA 5 ชอ้นแอโรว์           None   
88553               ขายทำคืน NEOS PACIFICE AROMATIC         661522   
88554             ALLOWRIE เนยสดเค็มถ้วยเล็ก 10กรัม           None   
88555               TOUCH มีดสเตนเลสตัดพิซซ่า 20358            NaN   

        pr_barcode2 sort_weight master_online SaleMode_unit ba_nprice  
0      841013411860           0             Y          ITEM    367.00  
1      880107311389           0             Y          ITEM     55.00  
2           2203790           0             N          ITEM    824.00  
3      885333301638           0             Y          ITEM     68.00  
4              None         0.0          None          None      None  
...             ...         ...           ...           ...       ...  
88551  885035804050           0             N          ITEM    150.00  
88552          None         0.0          None          None      None  
88553         66152           0             N          ITEM    230.00  
88554          None         0.0          None          None      None  
88555           NaN         0.0           NaN           NaN       NaN  

[88556 rows x 55 columns]
hashKey is allData-hash
saving hash to s3
saved hash d6cdaf07faa9f552c792296a88de1863cc3fac6a
saving to remote cache
{&#39;iprcode&#39;: &#39;0140942&#39;, &#39;cprcode&#39;: &#39;0140942&#39;, &#39;oprcode&#39;: &#39;0140942&#39;, &#39;ordertype&#39;: &#39;Y&#39;, &#39;pr_abb&#39;: &#39;FRAGATA OLIVE POMACE&#39;, &#39;pr_active&#39;: &#39;Y&#39;, &#39;pr_cgcode&#39;: &#39;01&#39;, &#39;pr_code&#39;: &#39;0140942&#39;, &#39;pr_dpcode&#39;: &#39;08&#39;, &#39;pr_engname&#39;: &#39;FRAGATA OLIVE POMACE OIL 2 LITE&#39;, &#39;pr_ggcode&#39;: &#39;008&#39;, &#39;pr_market&#39;: &#39;FRAGATA น้ำมันมะกอกธรรมชาติผสม&#39;, &#39;pr_name&#39;: &#39;FRAGATA น้ำมันมะกอกธรรมชาติ-กรรมวิธี 2 ลิตร&#39;, &#39;pr_puqty&#39;: &#39;8.00&#39;, &#39;pr_sa_method&#39;: &#39;1&#39;, &#39;pr_sucode1&#39;: &#39;1036&#39;, &#39;pr_suref3&#39;: &#39;A&#39;, &#39;prtype&#39;: &#39;I&#39;, &#39;psqty&#39;: &#39;1&#39;, &#39;pstype&#39;: &#39;1&#39;, &#39;pr_country_th&#39;: &#39;&#39;, &#39;pr_country_en&#39;: &#39;&#39;, &#39;pr_keyword_th&#39;: &#39;&#39;, &#39;pr_keyword_en&#39;: &#39;cooking oil, oil cooking,Fragata Olive Pomace Oil, Fragata, Olive purity pomace oil, Omace oil olive pomace oil, cooking olive pomace oil, olive pomace oil cooking&#39;, &#39;pr_filter_th&#39;: &#39;Oils  Vinegar,Grocery&#39;, &#39;pr_filter_en&#39;: &#39;Oils  Vinegar,Grocery&#39;, &#39;online_category_l1_th&#39;: &#39;สินค้าบริโภค&#39;, &#39;online_category_l1_en&#39;: &#39;Grocery&#39;, &#39;online_category_l2_th&#39;: &#39;น้ำมันและน้ำส้มสายชู&#39;, &#39;online_category_l2_en&#39;: &#39;Oils &amp; Vinegar&#39;, &#39;online_category_l3_th&#39;: &#39;&#39;, &#39;online_category_l3_en&#39;: &#39;Cooking Oils&#39;, &#39;villa_category_l1_en&#39;: &#39;Dry Grocery&#39;, &#39;villa_category_l2_en&#39;: &#39;Grocery&#39;, &#39;villa_category_l3_en&#39;: &#39;Oil &amp; Seasoning &amp; Sauce&#39;, &#39;villa_category_l4_en&#39;: &#39;Cooking Oil&#39;, &#39;content_en&#39;: &#39;0140942 0140942 Fragata Olive Pomace Oil 2L cooking oil, oil cooking,Fragata Olive Pomace Oil, Fragata, Olive purity pomace oil, Omace oil olive pomace oil, cooking olive pomace oil, olive pomace oil cooking\r\n 0140942-8410134118601 Fragata cooking oil, oil cooking,Fragata Olive Pomace Oil, Fragata, Olive purity pomace oil, Omace oil olive pomace oil, cooking olive pomace oil, olive pomace oil cooking&#39;, &#39;content_th&#39;: &#39;Fragata Olive Pomace Oil 2L Fragata&#39;, &#39;hema_brand_th&#39;: &#39;Fragata&#39;, &#39;hema_brand_en&#39;: &#39;Fragata&#39;, &#39;hema_sizedesc&#39;: &#39;2L&#39;, &#39;pr_brand_en&#39;: &#39;Fragata&#39;, &#39;pr_brand_th&#39;: &#39;Fragata&#39;, &#39;pr_online_name_en&#39;: &#39;Fragata Olive Pomace Oil 2L&#39;, &#39;pr_online_name_th&#39;: &#39;Fragata Olive Pomace Oil 2L&#39;, &#39;hema_name_en&#39;: &#39;Olive Pomace Oil&#39;, &#39;hema_name_th&#39;: &#39;Olive Pomace Oil&#39;, &#39;pr_name_en&#39;: &#39;FRAGATA OLIVE POMACE OIL 2 LITE&#39;, &#39;pr_name_th&#39;: &#39;FRAGATA น้ำมันมะกอกธรรมชาติ-กรรมวิธี 2 ลิตร&#39;, &#39;pr_barcode&#39;: &#39;8410134118601&#39;, &#39;pr_barcode2&#39;: &#39;841013411860&#39;, &#39;sort_weight&#39;: &#39;0&#39;, &#39;master_online&#39;: &#39;Y&#39;, &#39;SaleMode_unit&#39;: &#39;ITEM&#39;, &#39;ba_nprice&#39;: &#39;367.00&#39;}
CPU times: user 14.1 s, sys: 1.04 s, total: 15.2 s
Wall time: 17.9 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">product</span><span class="o">.</span><span class="n">loadFromCache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading hashkey allData-hash
loaded hash is b742d2a5a3a4b12814b1a524222ae52dc371bfe5
data is still in sync, using local cache
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cprcode</th>
      <th>iprcode</th>
      <th>oprcode</th>
      <th>ordertype</th>
      <th>pr_abb</th>
      <th>pr_active</th>
      <th>pr_cgcode</th>
      <th>pr_code</th>
      <th>pr_dpcode</th>
      <th>pr_engname</th>
      <th>...</th>
      <th>pr_keyword_th</th>
      <th>pr_name_en</th>
      <th>pr_name_th</th>
      <th>pr_online_name_en</th>
      <th>pr_online_name_th</th>
      <th>sort_weight</th>
      <th>villa_category_l1_en</th>
      <th>villa_category_l2_en</th>
      <th>villa_category_l3_en</th>
      <th>villa_category_l4_en</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0235414</td>
      <td>0235414</td>
      <td>0235414</td>
      <td>Y</td>
      <td>BIO CARROT SEEDS</td>
      <td>Y</td>
      <td>05</td>
      <td>0235414</td>
      <td>19</td>
      <td>BIO CARROT SEEDS</td>
      <td>...</td>
      <td></td>
      <td>BIO CARROT SEEDS</td>
      <td>BIO CARROT SEEDS</td>
      <td>BIO CARROT SEEDS</td>
      <td>BIO CARROT SEEDS</td>
      <td>0</td>
      <td>Fresh</td>
      <td>Fresh Produce</td>
      <td>Fruits &amp; Vegetable Import</td>
      <td>Import Vegetable</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0220492</td>
      <td>0220492</td>
      <td>0220492</td>
      <td>Y</td>
      <td>COCOA DUTCH REFILL 3</td>
      <td>Y</td>
      <td>01</td>
      <td>0220492</td>
      <td>05</td>
      <td>COCOA DUTCH REFILL 350G</td>
      <td>...</td>
      <td></td>
      <td>COCOA DUTCH REFILL 350G</td>
      <td>โกโก้ดัทช์ ชนิดเติม 350กรัม</td>
      <td>Cocoa Dutch Cocoa Powder 350g</td>
      <td>Cocoa Dutch Cocoa Powder 350g</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Grocery</td>
      <td>Hot Beverages</td>
      <td>Cocoa/Tea/Coffee</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0177701</td>
      <td>0177701</td>
      <td>0177701</td>
      <td>Y</td>
      <td>NOTEBOOK 9/100</td>
      <td>Y</td>
      <td>02</td>
      <td>0177701</td>
      <td>30</td>
      <td>NOTEBOOK 9/100</td>
      <td>...</td>
      <td></td>
      <td>NOTEBOOK 9/100</td>
      <td>สมุดปกแข็ง 9/100</td>
      <td>NOTEBOOK 9/100</td>
      <td>NOTEBOOK 9/100</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Store Supply</td>
      <td>Stationary</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>0190154</td>
      <td>0190154</td>
      <td>0190154</td>
      <td>Y</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>Y</td>
      <td>48</td>
      <td>0190154</td>
      <td>19</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>...</td>
      <td></td>
      <td>SPECIAL PRODUCT 2</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Alcohol &amp; Beverage</td>
      <td>RTD</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>0062012</td>
      <td>0062012</td>
      <td>0062012</td>
      <td>Y</td>
      <td>WAI WAI BROWIR RICE</td>
      <td>Y</td>
      <td>01</td>
      <td>0062012</td>
      <td>03</td>
      <td>WAI WAI BROWIR RICE VERMICELLI 170 G.</td>
      <td>...</td>
      <td></td>
      <td>WAI WAI BROWIR RICE VERMICELLI 170 G.</td>
      <td>WAI WAI เส้นหมี่ข้าวกล้อง 170 ก.</td>
      <td>Wai Wai Browir Rice Vermicelli  170g</td>
      <td>Wai Wai Browir Rice Vermicelli  170g</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Grocery</td>
      <td>Pasta</td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>496</th>
      <td>0205990</td>
      <td>0205990</td>
      <td>0205990</td>
      <td>Y</td>
      <td>Foremost Yoghurt Mix</td>
      <td>Y</td>
      <td>85</td>
      <td>0205990</td>
      <td>23</td>
      <td>FOREMOST YOGHURT MIXED FRUITS</td>
      <td>...</td>
      <td>โยเกิร์ต</td>
      <td>FOREMOST YOGHURT MIXED FRUITS</td>
      <td>โฟร์โมสต์ โยเกิต ผลไม้รวม 135*4</td>
      <td>Foremost Yoghurt Mixed Fruits</td>
      <td>โฟร์โมสต์ โยเกิต ผลไม้รวม 135*4</td>
      <td>0</td>
      <td>Fresh</td>
      <td>Dairy</td>
      <td>Yogurt</td>
      <td></td>
    </tr>
    <tr>
      <th>497</th>
      <td>0211914</td>
      <td>0211914</td>
      <td>0211914</td>
      <td>Y</td>
      <td>CPBALANCE CHILLI RIC</td>
      <td>Y</td>
      <td>84</td>
      <td>0211914</td>
      <td>22</td>
      <td>CPBALANCE CHILLI RICECHICKEN BREAST</td>
      <td>...</td>
      <td>Frozen, Frozen meal</td>
      <td>CPBALANCE CHILLI RICECHICKEN BREAST</td>
      <td>ข้าวน้ำพริกอกไก่ ซีพีบาลานซ์</td>
      <td>Cp balance Chilli Ricechicken Breast 190g</td>
      <td>Cp balance Chilli Ricechicken Breast 190g</td>
      <td>0</td>
      <td>Fresh</td>
      <td>Frozen</td>
      <td>Frozen Meal</td>
      <td></td>
    </tr>
    <tr>
      <th>498</th>
      <td>0239245</td>
      <td>0239245</td>
      <td>0239245</td>
      <td>Y</td>
      <td>DOGSTER PLAY CHICKEN</td>
      <td>Y</td>
      <td>54</td>
      <td>0239245</td>
      <td>19</td>
      <td>DOGSTER PLAY CHICKEN MEAT FORMULA 40G</td>
      <td>...</td>
      <td>dogster,หมา,อาหารหมา,สัตว์เลี้ยง</td>
      <td>DOGSTER PLAY CHICKEN MEAT FORMULA 40G</td>
      <td>(รับ)ด็อกส์เตอร์เพลย์ สูตรเนื้อไก่</td>
      <td>DOGSTER PLAY CHICKEN MEAT FORMULA 40G</td>
      <td>DOGSTER PLAY CHICKEN MEAT FORMULA 40G</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Household</td>
      <td>Pet Supplies</td>
      <td>Dog</td>
    </tr>
    <tr>
      <th>499</th>
      <td>0139097</td>
      <td>0139097</td>
      <td>0139097</td>
      <td>Y</td>
      <td>LEFFE BROWN 330 ML</td>
      <td>Y</td>
      <td>08</td>
      <td>0139097</td>
      <td>01</td>
      <td>LEFFE BROWN 330 ML</td>
      <td>...</td>
      <td>เบียร์,เบียร์กระป๋อง,เบียร์ขวด,เบียร์ลัง,เบียร...</td>
      <td>LEFFE BROWN 330 ML</td>
      <td>LEFFE BROWN 330 ML</td>
      <td>Leffe Brown  330ml</td>
      <td>Leffe Brown  330ml</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Alcohol &amp; Beverage</td>
      <td>Beer Import</td>
      <td>Beer Import</td>
    </tr>
    <tr>
      <th>500</th>
      <td>None</td>
      <td>0048935</td>
      <td>0048935</td>
      <td>Y</td>
      <td>HEINZ PARSNIPS</td>
      <td>Y</td>
      <td>05</td>
      <td>0048935</td>
      <td>05</td>
      <td>HEINZ PARSNIPS  CARROTS+SWEET POTATO 110</td>
      <td>...</td>
      <td></td>
      <td>HEINZ PARSNIPS  CARROTS+SWEET POTATO 110</td>
      <td>HEINZ หัวไชเท้า+แครอท+มันฝรั่ง 110ก.</td>
      <td>Heinz Parsnips Carrots+Sweet Potato 110g</td>
      <td>Heinz Parsnips Carrots+Sweet Potato 110g</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Grocery</td>
      <td>Baby Food &amp; Milk / Breakfast Food</td>
      <td>Baby Food</td>
    </tr>
  </tbody>
</table>
<p>501 rows × 55 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save-using-Standard-(instant-save)">Save using Standard (instant save)<a class="anchor-link" href="#Save-using-Standard-(instant-save)"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Product" class="doc_header"><code>class</code> <code>Product</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L130" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Product</code>(<strong><code>iprcode</code></strong>:<code>str</code>, <strong><code>cprcode</code></strong>:<code>str</code>, <strong><code>data</code></strong>:<code>Optional</code>[<code>CatchAllVar</code>])</p>
</blockquote>
<p>Product(iprcode: str, cprcode: str, data: Union[~CatchAllVar, NoneType])</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ValueUpdate" class="doc_header"><code>class</code> <code>ValueUpdate</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L136" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ValueUpdate</code>(<strong><code>items</code></strong>:<code>List</code>[<a href="/villaProductDatabase/database.html#Product"><code>Product</code></a>])</p>
</blockquote>
<p>ValueUpdate(items: List[villaProductDatabase.database.Product])</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="chunks" class="doc_header"><code>chunks</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L140" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>chunks</code>(<strong><code>l</code></strong>, <strong><code>n</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">chunks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)),</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
 [10, 11, 12, 13, 14, 15, 16, 17, 18, 19],
 [20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
 [30, 31, 32, 33, 34, 35, 36, 37, 38, 39],
 [40, 41, 42, 43, 44, 45, 46, 47, 48, 49],
 [50, 51, 52, 53, 54, 55, 56, 57, 58, 59],
 [60, 61, 62, 63, 64, 65, 66, 67, 68, 69],
 [70, 71, 72, 73, 74, 75, 76, 77, 78, 79],
 [80, 81, 82, 83, 84, 85, 86, 87, 88, 89],
 [90, 91, 92, 93, 94, 95, 96, 97, 98, 99]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sampleProducts</span> <span class="o">=</span> <span class="p">[{</span> <span class="s1">&#39;cprcode&#39;</span><span class="p">:</span> <span class="s1">&#39;0171670&#39;</span><span class="p">,</span> <span class="s1">&#39;iprcode&#39;</span><span class="p">:</span> <span class="s1">&#39;0171670&#39;</span><span class="p">,</span> <span class="s1">&#39;oprcode&#39;</span><span class="p">:</span> <span class="s1">&#39;0171670&#39;</span><span class="p">,</span> <span class="s1">&#39;ordertype&#39;</span><span class="p">:</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_abb&#39;</span><span class="p">:</span> <span class="s1">&#39;JIRAPAT YOUNG KALE 2&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_active&#39;</span><span class="p">:</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_cgcode&#39;</span><span class="p">:</span> <span class="s1">&#39;05&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_code&#39;</span><span class="p">:</span> <span class="s1">&#39;0171670&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_dpcode&#39;</span><span class="p">:</span> <span class="s1">&#39;19&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_engname&#39;</span><span class="p">:</span> <span class="s1">&#39;JIRAAT YOUNG KALE 200 G.&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_ggcode&#39;</span><span class="p">:</span> <span class="s1">&#39;057&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_market&#39;</span><span class="p">:</span> <span class="s1">&#39;JIRAPAT ยอดคะน้า 200 G.&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_name&#39;</span><span class="p">:</span> <span class="s1">&#39;JIRAPAT ยอดคะน้า 200 G.&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_puqty&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_sa_method&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_sucode1&#39;</span><span class="p">:</span> <span class="s1">&#39;CM845&#39;</span><span class="p">,</span> <span class="s1">&#39;pr_suref3&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;prtype&#39;</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;psqty&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;pstype&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">}]</span> <span class="c1">#ProductDatabase.valueUpdate({&#39;items&#39;:sampleProducts})</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">ValueUpdate</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s1">&#39;items&#39;</span><span class="p">:</span><span class="n">sampleProducts</span><span class="p">})</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="c1"># print(products[0])</span>
<span class="n">ProductDatabase</span><span class="o">.</span><span class="n">valueUpdate2</span><span class="p">(</span><span class="n">products</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input validated 0.014 ms
divided into chunks 0.125 ms
loading hashkey allData-hash
loaded hash is b742d2a5a3a4b12814b1a524222ae52dc371bfe5
data is still in sync, using local cache
get all from s3 112.628 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;success&#39;: 1,
 &#39;failure&#39;: 0,
 &#39;skipped&#39;: 0,
 &#39;failureMessage&#39;: [],
 &#39;timetaken(ms)&#39;: 115.861}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lambdaUpdateProduct" class="doc_header"><code>lambdaUpdateProduct</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L143" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lambdaUpdateProduct</code>(<strong><code>event</code></strong>, <strong><code>_</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">(</span><span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;products&#39;</span><span class="p">:</span><span class="n">sampleProducts</span><span class="p">})</span>
<span class="n">lambdaUpdateProduct</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input validated 0.012 ms
divided into chunks 0.5559999999999999 ms
loading hashkey allData-hash
loaded hash is b742d2a5a3a4b12814b1a524222ae52dc371bfe5
data is still in sync, using local cache
get all from s3 165.01 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;{&#34;success&#34;:1,&#34;failure&#34;:0,&#34;skipped&#34;:0,&#34;failureMessage&#34;:[],&#34;timetaken(ms)&#34;:167.906}&#39;,
 &#39;statusCode&#39;: 200,
 &#39;headers&#39;: {&#39;Access-Control-Allow-Headers&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Methods&#39;: &#39;*&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save-using-s3">Save using s3<a class="anchor-link" href="#Save-using-s3"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="update-using-s3-link">update using s3 link<a class="anchor-link" href="#update-using-s3-link"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="updateS3Input" class="doc_header"><code>updateS3Input</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L149" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>updateS3Input</code>(<strong><code>inputBucketName</code></strong>=<em><code>None</code></em>, <strong><code>key</code></strong>=<em><code>''</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputKeyName</span> <span class="o">=</span> <span class="s1">&#39;input-data-name&#39;</span>
<span class="n">saveResult</span> <span class="o">=</span> <span class="n">S3</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">inputKeyName</span><span class="p">,</span> 
                     <span class="n">objectToSave</span> <span class="o">=</span> <span class="n">sampleProducts</span> <span class="p">,</span> 
                     <span class="n">bucket</span> <span class="o">=</span> <span class="n">INPUT_BUCKET_NAME</span><span class="p">,</span>
                     <span class="n">accelerate</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;test input data saved to s3&#39;</span><span class="p">)</span>
<span class="n">updateResult</span> <span class="o">=</span> <span class="n">ProductDatabase</span><span class="o">.</span><span class="n">updateS3Input</span><span class="p">(</span> <span class="n">inputBucketName</span><span class="o">=</span><span class="n">INPUT_BUCKET_NAME</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span> <span class="n">inputKeyName</span><span class="p">)</span>

<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;s3 save result is </span><span class="si">{</span><span class="n">saveResult</span><span class="si">}</span><span class="s1"> update result is </span><span class="si">{</span><span class="n">updateResult</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input validated 0.014 ms
divided into chunks 0.12000000000000001 ms
loading hashkey allData-hash
loaded hash is b742d2a5a3a4b12814b1a524222ae52dc371bfe5
data is still in sync, using local cache
get all from s3 225.839 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lambdaUpdateS3" class="doc_header"><code>lambdaUpdateS3</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L157" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lambdaUpdateS3</code>(<strong><code>event</code></strong>, <strong><code>_</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputKeyName</span> <span class="o">=</span> <span class="s1">&#39;input-data-name&#39;</span>
<span class="n">saveResult</span> <span class="o">=</span> <span class="n">S3</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">inputKeyName</span><span class="p">,</span> 
                     <span class="n">objectToSave</span> <span class="o">=</span> <span class="n">sampleProducts</span> <span class="p">,</span> 
                     <span class="n">bucket</span> <span class="o">=</span> <span class="n">INPUT_BUCKET_NAME</span><span class="p">)</span>
<span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="n">inputKeyName</span><span class="p">})</span>
<span class="n">lambdaUpdateS3</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input validated 0.014 ms
divided into chunks 0.12300000000000001 ms
loading hashkey allData-hash
loaded hash is b742d2a5a3a4b12814b1a524222ae52dc371bfe5
data is still in sync, using local cache
get all from s3 125.96499999999999 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;{&#34;success&#34;:1,&#34;failure&#34;:0,&#34;skipped&#34;:0,&#34;failureMessage&#34;:[],&#34;timetaken(ms)&#34;:129.01999999999998}&#39;,
 &#39;statusCode&#39;: 200,
 &#39;headers&#39;: {&#39;Access-Control-Allow-Headers&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Methods&#39;: &#39;*&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Query-test">Query test<a class="anchor-link" href="#Query-test"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Product-Query">Product Query<a class="anchor-link" href="#Product-Query"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ProductsFromList" class="doc_header"><code>class</code> <code>ProductsFromList</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L174" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ProductsFromList</code>(<strong><code>iprcodes</code></strong>:<code>List</code>[<code>str</code>])</p>
</blockquote>
<p>ProductsFromList(iprcodes: List[str])</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lambdaProductsFromList" class="doc_header"><code>lambdaProductsFromList</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L178" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lambdaProductsFromList</code>(<strong><code>event</code></strong>, <strong>*<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">({</span><span class="s1">&#39;iprcodes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0217153&#39;</span><span class="p">,</span><span class="s1">&#39;203915&#39;</span><span class="p">,</span><span class="s1">&#39;0000009&#39;</span><span class="p">]})</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">lambdaProductsFromList</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">Response</span><span class="o">.</span><span class="n">parseBody</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;result length is not 3 </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">,</span> <span class="s1">&#39;result type is not dict&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading hashkey allData-hash
loaded hash is b742d2a5a3a4b12814b1a524222ae52dc371bfe5
data is still in sync, using local cache
db shape is (501, 55)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;timed exec&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>

<span class="ansi-red-fg">AssertionError</span>: result length is not 3 0</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">({</span><span class="s1">&#39;iprcodes&#39;</span><span class="p">:[</span><span class="s1">&#39;0000009&#39;</span><span class="p">,</span><span class="s1">&#39;203915&#39;</span><span class="p">,</span><span class="s1">&#39;0217153&#39;</span><span class="p">]})</span>
<span class="n">lambdaProductsFromList</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading hashkey allData-hash
loaded hash is b742d2a5a3a4b12814b1a524222ae52dc371bfe5
data is still in sync, using local cache
db shape is (501, 55)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;[]&#39;,
 &#39;statusCode&#39;: 200,
 &#39;headers&#39;: {&#39;Access-Control-Allow-Headers&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Methods&#39;: &#39;*&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sampleQueryInput</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;iprcode&#39;</span><span class="p">:</span> <span class="s1">&#39;0171670&#39;</span>
<span class="p">}</span>  
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">ProductDatabase</span><span class="o">.</span><span class="n">singleProductQuery</span><span class="p">({</span><span class="s1">&#39;iprcode&#39;</span><span class="p">:</span><span class="s1">&#39;12345&#39;</span><span class="p">}))</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>product not found
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ProductDatabase</span><span class="o">.</span><span class="n">singleProductQuery</span><span class="p">(</span><span class="n">sampleQueryInput</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>iprcode                          0171670
cprcode                          0171670
oprcode                          0171670
ordertype                              Y
pr_abb              JIRAPAT YOUNG KALE 2
pr_active                              Y
pr_cgcode                             05
pr_code                          0171670
pr_dpcode                             19
pr_engname      JIRAAT YOUNG KALE 200 G.
pr_ggcode                            057
pr_market        JIRAPAT ยอดคะน้า 200 G.
pr_name          JIRAPAT ยอดคะน้า 200 G.
pr_puqty                               1
pr_sa_method                           1
pr_sucode1                         CM845
pr_suref3                              A
prtype                                 I
psqty                                  1
pstype                                 1
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lambdaSingleQuery" class="doc_header"><code>lambdaSingleQuery</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L186" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lambdaSingleQuery</code>(<strong><code>event</code></strong>, <strong><code>_</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">body</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sampleQueryInput</span><span class="p">))</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">lambdaSingleQuery</span><span class="p">(</span><span class="n">event</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;{&#34;iprcode&#34;:&#34;0171670&#34;,&#34;cprcode&#34;:&#34;0171670&#34;,&#34;oprcode&#34;:&#34;0171670&#34;,&#34;ordertype&#34;:&#34;Y&#34;,&#34;pr_abb&#34;:&#34;JIRAPAT YOUNG KALE 2&#34;,&#34;pr_active&#34;:&#34;Y&#34;,&#34;pr_cgcode&#34;:&#34;05&#34;,&#34;pr_code&#34;:&#34;0171670&#34;,&#34;pr_dpcode&#34;:&#34;19&#34;,&#34;pr_engname&#34;:&#34;JIRAAT YOUNG KALE 200 G.&#34;,&#34;pr_ggcode&#34;:&#34;057&#34;,&#34;pr_market&#34;:&#34;JIRAPAT \\u0e22\\u0e2d\\u0e14\\u0e04\\u0e30\\u0e19\\u0e49\\u0e32 200 G.&#34;,&#34;pr_name&#34;:&#34;JIRAPAT \\u0e22\\u0e2d\\u0e14\\u0e04\\u0e30\\u0e19\\u0e49\\u0e32 200 G.&#34;,&#34;pr_puqty&#34;:&#34;1&#34;,&#34;pr_sa_method&#34;:&#34;1&#34;,&#34;pr_sucode1&#34;:&#34;CM845&#34;,&#34;pr_suref3&#34;:&#34;A&#34;,&#34;prtype&#34;:&#34;I&#34;,&#34;psqty&#34;:&#34;1&#34;,&#34;pstype&#34;:&#34;1&#34;}&#39;,
 &#39;statusCode&#39;: 200,
 &#39;headers&#39;: {&#39;Access-Control-Allow-Headers&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Methods&#39;: &#39;*&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">lambdaSingleQuery</span><span class="p">(</span><span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">({</span><span class="s1">&#39;iprcode&#39;</span><span class="p">:</span><span class="s1">&#39;11234&#39;</span><span class="p">}),</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">Response</span><span class="o">.</span><span class="n">parseBody</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;error&#39;: &#39;product not found&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="AllQuery">AllQuery<a class="anchor-link" href="#AllQuery"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">s3bz.s3bz</span> <span class="kn">import</span> <span class="n">Requests</span>
<span class="kn">import</span> <span class="nn">zlib</span>
<span class="o">%</span><span class="k">time</span> url = ProductDatabase.allQuery(bucket = INVENTORY_BUCKET_NAME, key=&#39;allData-json.zl&#39;)
<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="c1"># response = requests.get(url)</span>
<span class="k">def</span> <span class="nf">retrieveJsonZl</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
  <span class="n">response</span><span class="p">:</span><span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span>
    <span class="n">jsonDb</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">newDb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">jsonDb</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;split&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newDb</span>
<span class="o">%</span><span class="k">time</span> newDb = retrieveJsonZl(url)
<span class="n">newDb</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>product-bucket-dev-manual
CPU times: user 6.17 ms, sys: 55 µs, total: 6.22 ms
Wall time: 6.93 ms
https://product-bucket-dev-manual.s3-accelerate.amazonaws.com/allData-json.zl?AWSAccessKeyId=AKIAVX4Z5TKDSNNNULGB&amp;Signature=LDfUCBeIBKZ3XAY0e5qwcHaEH8o%3D&amp;Expires=1611299229
CPU times: user 61.2 ms, sys: 140 µs, total: 61.3 ms
Wall time: 123 ms
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cprcode</th>
      <th>iprcode</th>
      <th>oprcode</th>
      <th>ordertype</th>
      <th>pr_abb</th>
      <th>pr_active</th>
      <th>pr_cgcode</th>
      <th>pr_code</th>
      <th>pr_dpcode</th>
      <th>pr_engname</th>
      <th>...</th>
      <th>pr_keyword_th</th>
      <th>pr_name_en</th>
      <th>pr_name_th</th>
      <th>pr_online_name_en</th>
      <th>pr_online_name_th</th>
      <th>sort_weight</th>
      <th>villa_category_l1_en</th>
      <th>villa_category_l2_en</th>
      <th>villa_category_l3_en</th>
      <th>villa_category_l4_en</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>235414.0</td>
      <td>235414</td>
      <td>235414</td>
      <td>Y</td>
      <td>BIO CARROT SEEDS</td>
      <td>Y</td>
      <td>5</td>
      <td>235414</td>
      <td>19</td>
      <td>BIO CARROT SEEDS</td>
      <td>...</td>
      <td></td>
      <td>BIO CARROT SEEDS</td>
      <td>BIO CARROT SEEDS</td>
      <td>BIO CARROT SEEDS</td>
      <td>BIO CARROT SEEDS</td>
      <td>0</td>
      <td>Fresh</td>
      <td>Fresh Produce</td>
      <td>Fruits &amp; Vegetable Import</td>
      <td>Import Vegetable</td>
    </tr>
    <tr>
      <th>1</th>
      <td>220492.0</td>
      <td>220492</td>
      <td>220492</td>
      <td>Y</td>
      <td>COCOA DUTCH REFILL 3</td>
      <td>Y</td>
      <td>1</td>
      <td>220492</td>
      <td>5</td>
      <td>COCOA DUTCH REFILL 350G</td>
      <td>...</td>
      <td></td>
      <td>COCOA DUTCH REFILL 350G</td>
      <td>โกโก้ดัทช์ ชนิดเติม 350กรัม</td>
      <td>Cocoa Dutch Cocoa Powder 350g</td>
      <td>Cocoa Dutch Cocoa Powder 350g</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Grocery</td>
      <td>Hot Beverages</td>
      <td>Cocoa/Tea/Coffee</td>
    </tr>
    <tr>
      <th>2</th>
      <td>177701.0</td>
      <td>177701</td>
      <td>177701</td>
      <td>Y</td>
      <td>NOTEBOOK 9/100</td>
      <td>Y</td>
      <td>2</td>
      <td>177701</td>
      <td>30</td>
      <td>NOTEBOOK 9/100</td>
      <td>...</td>
      <td></td>
      <td>NOTEBOOK 9/100</td>
      <td>สมุดปกแข็ง 9/100</td>
      <td>NOTEBOOK 9/100</td>
      <td>NOTEBOOK 9/100</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Store Supply</td>
      <td>Stationary</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>190154.0</td>
      <td>190154</td>
      <td>190154</td>
      <td>Y</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>Y</td>
      <td>48</td>
      <td>190154</td>
      <td>19</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>...</td>
      <td></td>
      <td>SPECIAL PRODUCT 2</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Alcohol &amp; Beverage</td>
      <td>RTD</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>62012.0</td>
      <td>62012</td>
      <td>62012</td>
      <td>Y</td>
      <td>WAI WAI BROWIR RICE</td>
      <td>Y</td>
      <td>1</td>
      <td>62012</td>
      <td>3</td>
      <td>WAI WAI BROWIR RICE VERMICELLI 170 G.</td>
      <td>...</td>
      <td></td>
      <td>WAI WAI BROWIR RICE VERMICELLI 170 G.</td>
      <td>WAI WAI เส้นหมี่ข้าวกล้อง 170 ก.</td>
      <td>Wai Wai Browir Rice Vermicelli  170g</td>
      <td>Wai Wai Browir Rice Vermicelli  170g</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Grocery</td>
      <td>Pasta</td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>5 rows × 55 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">newDb</span><span class="p">[</span><span class="s1">&#39;online_category_l1_en&#39;</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">newDb</span><span class="p">[</span><span class="s1">&#39;online_category_l1_en&#39;</span><span class="p">]))</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>272</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">newDb</span><span class="p">[</span><span class="s1">&#39;online_category_l1_en&#39;</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>229</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newDb</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;cprcode&#39;, &#39;iprcode&#39;, &#39;oprcode&#39;, &#39;ordertype&#39;, &#39;pr_abb&#39;, &#39;pr_active&#39;,
       &#39;pr_cgcode&#39;, &#39;pr_code&#39;, &#39;pr_dpcode&#39;, &#39;pr_engname&#39;, &#39;pr_ggcode&#39;,
       &#39;pr_market&#39;, &#39;pr_name&#39;, &#39;pr_puqty&#39;, &#39;pr_sa_method&#39;, &#39;pr_sucode1&#39;,
       &#39;pr_suref3&#39;, &#39;prtype&#39;, &#39;psqty&#39;, &#39;pstype&#39;, &#39;SaleMode_unit&#39;, &#39;ba_nprice&#39;,
       &#39;content_en&#39;, &#39;content_th&#39;, &#39;hema_brand_en&#39;, &#39;hema_brand_th&#39;,
       &#39;hema_name_en&#39;, &#39;hema_name_th&#39;, &#39;hema_sizedesc&#39;, &#39;master_online&#39;,
       &#39;online_category_l1_en&#39;, &#39;online_category_l1_th&#39;,
       &#39;online_category_l2_en&#39;, &#39;online_category_l2_th&#39;,
       &#39;online_category_l3_en&#39;, &#39;online_category_l3_th&#39;, &#39;pr_barcode&#39;,
       &#39;pr_barcode2&#39;, &#39;pr_brand_en&#39;, &#39;pr_brand_th&#39;, &#39;pr_country_en&#39;,
       &#39;pr_country_th&#39;, &#39;pr_filter_en&#39;, &#39;pr_filter_th&#39;, &#39;pr_keyword_en&#39;,
       &#39;pr_keyword_th&#39;, &#39;pr_name_en&#39;, &#39;pr_name_th&#39;, &#39;pr_online_name_en&#39;,
       &#39;pr_online_name_th&#39;, &#39;sort_weight&#39;, &#39;villa_category_l1_en&#39;,
       &#39;villa_category_l2_en&#39;, &#39;villa_category_l3_en&#39;, &#39;villa_category_l4_en&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newDb</span><span class="p">[</span><span class="s1">&#39;pr_suref3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>A    366
T     60
C     38
S     37
Name: pr_suref3, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lambdaAllQuery" class="doc_header"><code>lambdaAllQuery</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L195" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lambdaAllQuery</code>(<strong><code>event</code></strong>, <strong>*<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">s3bz.s3bz</span> <span class="kn">import</span> <span class="n">Requests</span>
<span class="o">%</span><span class="k">time</span> url = Response.fromDict(lambdaAllQuery(&#39;&#39;, &#39;&#39;)).body[&#39;url&#39;]
<span class="o">%</span><span class="k">time</span> newDb = retrieveJsonZl(url)
<span class="n">newDb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>product-bucket-dev-manual
CPU times: user 6.3 ms, sys: 59 µs, total: 6.36 ms
Wall time: 5.96 ms
CPU times: user 53.9 ms, sys: 0 ns, total: 53.9 ms
Wall time: 100 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(501, 55)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="AllQueryFeather">AllQueryFeather<a class="anchor-link" href="#AllQueryFeather"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lambdaAllQueryFeather" class="doc_header"><code>lambdaAllQueryFeather</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L200" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lambdaAllQueryFeather</code>(<strong><code>event</code></strong>, <strong>*<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> r = lambdaAllQueryFeather(&#39;&#39;)
<span class="o">%</span><span class="k">time</span> result = Response.fromDict(r).body
<span class="n">url</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span>
<span class="o">%</span><span class="k">time</span> pd.read_feather(url)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>product-bucket-dev-manual
loading hashkey allData-hash
using url
presign success
loaded hash is b742d2a5a3a4b12814b1a524222ae52dc371bfe5
CPU times: user 23.4 ms, sys: 7.97 ms, total: 31.4 ms
Wall time: 126 ms
CPU times: user 18 µs, sys: 1e+03 ns, total: 19 µs
Wall time: 22.6 µs
CPU times: user 18.6 ms, sys: 3.9 ms, total: 22.5 ms
Wall time: 83.7 ms
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cprcode</th>
      <th>iprcode</th>
      <th>oprcode</th>
      <th>ordertype</th>
      <th>pr_abb</th>
      <th>pr_active</th>
      <th>pr_cgcode</th>
      <th>pr_code</th>
      <th>pr_dpcode</th>
      <th>pr_engname</th>
      <th>...</th>
      <th>pr_keyword_th</th>
      <th>pr_name_en</th>
      <th>pr_name_th</th>
      <th>pr_online_name_en</th>
      <th>pr_online_name_th</th>
      <th>sort_weight</th>
      <th>villa_category_l1_en</th>
      <th>villa_category_l2_en</th>
      <th>villa_category_l3_en</th>
      <th>villa_category_l4_en</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0235414</td>
      <td>0235414</td>
      <td>0235414</td>
      <td>Y</td>
      <td>BIO CARROT SEEDS</td>
      <td>Y</td>
      <td>05</td>
      <td>0235414</td>
      <td>19</td>
      <td>BIO CARROT SEEDS</td>
      <td>...</td>
      <td></td>
      <td>BIO CARROT SEEDS</td>
      <td>BIO CARROT SEEDS</td>
      <td>BIO CARROT SEEDS</td>
      <td>BIO CARROT SEEDS</td>
      <td>0</td>
      <td>Fresh</td>
      <td>Fresh Produce</td>
      <td>Fruits &amp; Vegetable Import</td>
      <td>Import Vegetable</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0220492</td>
      <td>0220492</td>
      <td>0220492</td>
      <td>Y</td>
      <td>COCOA DUTCH REFILL 3</td>
      <td>Y</td>
      <td>01</td>
      <td>0220492</td>
      <td>05</td>
      <td>COCOA DUTCH REFILL 350G</td>
      <td>...</td>
      <td></td>
      <td>COCOA DUTCH REFILL 350G</td>
      <td>โกโก้ดัทช์ ชนิดเติม 350กรัม</td>
      <td>Cocoa Dutch Cocoa Powder 350g</td>
      <td>Cocoa Dutch Cocoa Powder 350g</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Grocery</td>
      <td>Hot Beverages</td>
      <td>Cocoa/Tea/Coffee</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0177701</td>
      <td>0177701</td>
      <td>0177701</td>
      <td>Y</td>
      <td>NOTEBOOK 9/100</td>
      <td>Y</td>
      <td>02</td>
      <td>0177701</td>
      <td>30</td>
      <td>NOTEBOOK 9/100</td>
      <td>...</td>
      <td></td>
      <td>NOTEBOOK 9/100</td>
      <td>สมุดปกแข็ง 9/100</td>
      <td>NOTEBOOK 9/100</td>
      <td>NOTEBOOK 9/100</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Store Supply</td>
      <td>Stationary</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>0190154</td>
      <td>0190154</td>
      <td>0190154</td>
      <td>Y</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>Y</td>
      <td>48</td>
      <td>0190154</td>
      <td>19</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>...</td>
      <td></td>
      <td>SPECIAL PRODUCT 2</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>SPECIAL PRODUCT 2</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Alcohol &amp; Beverage</td>
      <td>RTD</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>0062012</td>
      <td>0062012</td>
      <td>0062012</td>
      <td>Y</td>
      <td>WAI WAI BROWIR RICE</td>
      <td>Y</td>
      <td>01</td>
      <td>0062012</td>
      <td>03</td>
      <td>WAI WAI BROWIR RICE VERMICELLI 170 G.</td>
      <td>...</td>
      <td></td>
      <td>WAI WAI BROWIR RICE VERMICELLI 170 G.</td>
      <td>WAI WAI เส้นหมี่ข้าวกล้อง 170 ก.</td>
      <td>Wai Wai Browir Rice Vermicelli  170g</td>
      <td>Wai Wai Browir Rice Vermicelli  170g</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Grocery</td>
      <td>Pasta</td>
      <td></td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>496</th>
      <td>0205990</td>
      <td>0205990</td>
      <td>0205990</td>
      <td>Y</td>
      <td>Foremost Yoghurt Mix</td>
      <td>Y</td>
      <td>85</td>
      <td>0205990</td>
      <td>23</td>
      <td>FOREMOST YOGHURT MIXED FRUITS</td>
      <td>...</td>
      <td>โยเกิร์ต</td>
      <td>FOREMOST YOGHURT MIXED FRUITS</td>
      <td>โฟร์โมสต์ โยเกิต ผลไม้รวม 135*4</td>
      <td>Foremost Yoghurt Mixed Fruits</td>
      <td>โฟร์โมสต์ โยเกิต ผลไม้รวม 135*4</td>
      <td>0</td>
      <td>Fresh</td>
      <td>Dairy</td>
      <td>Yogurt</td>
      <td></td>
    </tr>
    <tr>
      <th>497</th>
      <td>0211914</td>
      <td>0211914</td>
      <td>0211914</td>
      <td>Y</td>
      <td>CPBALANCE CHILLI RIC</td>
      <td>Y</td>
      <td>84</td>
      <td>0211914</td>
      <td>22</td>
      <td>CPBALANCE CHILLI RICECHICKEN BREAST</td>
      <td>...</td>
      <td>Frozen, Frozen meal</td>
      <td>CPBALANCE CHILLI RICECHICKEN BREAST</td>
      <td>ข้าวน้ำพริกอกไก่ ซีพีบาลานซ์</td>
      <td>Cp balance Chilli Ricechicken Breast 190g</td>
      <td>Cp balance Chilli Ricechicken Breast 190g</td>
      <td>0</td>
      <td>Fresh</td>
      <td>Frozen</td>
      <td>Frozen Meal</td>
      <td></td>
    </tr>
    <tr>
      <th>498</th>
      <td>0239245</td>
      <td>0239245</td>
      <td>0239245</td>
      <td>Y</td>
      <td>DOGSTER PLAY CHICKEN</td>
      <td>Y</td>
      <td>54</td>
      <td>0239245</td>
      <td>19</td>
      <td>DOGSTER PLAY CHICKEN MEAT FORMULA 40G</td>
      <td>...</td>
      <td>dogster,หมา,อาหารหมา,สัตว์เลี้ยง</td>
      <td>DOGSTER PLAY CHICKEN MEAT FORMULA 40G</td>
      <td>(รับ)ด็อกส์เตอร์เพลย์ สูตรเนื้อไก่</td>
      <td>DOGSTER PLAY CHICKEN MEAT FORMULA 40G</td>
      <td>DOGSTER PLAY CHICKEN MEAT FORMULA 40G</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Household</td>
      <td>Pet Supplies</td>
      <td>Dog</td>
    </tr>
    <tr>
      <th>499</th>
      <td>0139097</td>
      <td>0139097</td>
      <td>0139097</td>
      <td>Y</td>
      <td>LEFFE BROWN 330 ML</td>
      <td>Y</td>
      <td>08</td>
      <td>0139097</td>
      <td>01</td>
      <td>LEFFE BROWN 330 ML</td>
      <td>...</td>
      <td>เบียร์,เบียร์กระป๋อง,เบียร์ขวด,เบียร์ลัง,เบียร...</td>
      <td>LEFFE BROWN 330 ML</td>
      <td>LEFFE BROWN 330 ML</td>
      <td>Leffe Brown  330ml</td>
      <td>Leffe Brown  330ml</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Alcohol &amp; Beverage</td>
      <td>Beer Import</td>
      <td>Beer Import</td>
    </tr>
    <tr>
      <th>500</th>
      <td>None</td>
      <td>0048935</td>
      <td>0048935</td>
      <td>Y</td>
      <td>HEINZ PARSNIPS</td>
      <td>Y</td>
      <td>05</td>
      <td>0048935</td>
      <td>05</td>
      <td>HEINZ PARSNIPS  CARROTS+SWEET POTATO 110</td>
      <td>...</td>
      <td></td>
      <td>HEINZ PARSNIPS  CARROTS+SWEET POTATO 110</td>
      <td>HEINZ หัวไชเท้า+แครอท+มันฝรั่ง 110ก.</td>
      <td>Heinz Parsnips Carrots+Sweet Potato 110g</td>
      <td>Heinz Parsnips Carrots+Sweet Potato 110g</td>
      <td>0</td>
      <td>Dry Grocery</td>
      <td>Grocery</td>
      <td>Baby Food &amp; Milk / Breakfast Food</td>
      <td>Baby Food</td>
    </tr>
  </tbody>
</table>
<p>501 rows × 55 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">database</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">pdUtils</span><span class="o">.</span><span class="n">getDfHash</span><span class="p">(</span><span class="n">database</span><span class="p">)</span> <span class="o">==</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;hash&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;database and hash are not the same&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Update-s3,-checking-scan-time">Update s3, checking scan time<a class="anchor-link" href="#Update-s3,-checking-scan-time"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;checking scan time&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ProductDatabase</span><span class="o">.</span><span class="n">scan</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>checking scan time
CPU times: user 4.09 s, sys: 178 ms, total: 4.27 s
Wall time: 7.09 s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>24913</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clearCache" class="doc_header"><code>clearCache</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L208" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clearCache</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ProductDatabase</span><span class="o">.</span><span class="n">clearCache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>       iprcode  cprcode  oprcode ordertype                pr_abb pr_active  \
0      0140942  0140942  0140942         Y  FRAGATA OLIVE POMACE         Y   
1      0223750  0223750  0223750         Y  SAMYANG HOT CHICKHEN         Y   
2      0203790  0203790  0203790         Y  KRISTY HAMPER 2016 G         Y   
3      0207006  0207006  0207006         Y   MALEE 100%TANGERINE         Y   
4       235078   235078   235078         Y  PLANEAT ROASTED SEAS         Y   
...        ...      ...      ...       ...                   ...       ...   
88550   222555   222555   222555         Y  พวงมาลัยกล้วยไม้ 79บ         Y   
88551  0138956  0138956  0138956         Y  BONCHI CORP EBI AGES         Y   
88552   222318   222318   222318         Y  386372 PACK PT FREEE         Y   
88553  0066152  0066152  0066152         Y  NEOS  PACIFICE AROMA         Y   
88554   184290   184290   184290         Y  ALLOWRIE BUTTER SALT         Y   

      pr_cgcode  pr_code pr_dpcode                                pr_engname  \
0            01  0140942        08           FRAGATA OLIVE POMACE OIL 2 LITE   
1            04  0223750        03        SAMYANG HOT CHICKHEN CARBONARA130G   
2            45  0203790        19                  KRISTY HAMPER 2016 SET G   
3            03  0207006        20     MALEE 100%TANGERINE SUKHOTHAI 1000 ML   
4            31  0235078      19.0  PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...         ...      ...       ...                                       ...   
88550        27   222555      19.0                    พวงมาลัยกล้วยไม้ 79บาท   
88551        17  0138956        19                BONCHI CORP EBI AGESEN 92G   
88552         8   222318      19.0  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553        20  0066152        19                   NEOS  PACIFICE AROMATIC   
88554         1   184290      13.0              ALLOWRIE BUTTER SALTED 10 G.   

       ...                              hema_name_en  \
0      ...                          Olive Pomace Oil   
1      ...                   Hot Chickhen Carbonarag   
2      ...                  KRISTY HAMPER 2016 SET G   
3      ...                  100% Tangerine Sukhothai   
4      ...  PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...    ...                                       ...   
88550  ...                            Orchid Garland   
88551  ...                BONCHI CORP EBI AGESEN 92G   
88552  ...  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553  ...                   NEOS  PACIFICE AROMATIC   
88554  ...              ALLOWRIE BUTTER SALTED 10 G.   

                                   hema_name_th  \
0                              Olive Pomace Oil   
1                       Hot Chickhen Carbonarag   
2                      KRISTY HAMPER 2016 SET G   
3                      100% Tangerine Sukhothai   
4      PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...                                         ...   
88550                          พวงมาลัยกล้วยไม้   
88551                BONCHI CORP EBI AGESEN 92G   
88552  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553                   NEOS  PACIFICE AROMATIC   
88554              ALLOWRIE BUTTER SALTED 10 G.   

                                     pr_name_en  \
0               FRAGATA OLIVE POMACE OIL 2 LITE   
1            SAMYANG HOT CHICKHEN CARBONARA130G   
2                      KRISTY HAMPER 2016 SET G   
3         MALEE 100%TANGERINE SUKHOTHAI 1000 ML   
4      PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...                                         ...   
88550                    พวงมาลัยกล้วยไม้ 79บาท   
88551                BONCHI CORP EBI AGESEN 92G   
88552  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553                   NEOS  PACIFICE AROMATIC   
88554              ALLOWRIE BUTTER SALTED 10 G.   

                                         pr_name_th     pr_barcode  \
0       FRAGATA น้ำมันมะกอกธรรมชาติ-กรรมวิธี 2 ลิตร  8410134118601   
1              SAMYANG ฮอตชิคเค่น คาโบนาร่า 130กรัม  8801073113893   
2                          KRISTY HAMPER 2016 SET G       22037909   
3            มาลี น้ำส้มเขียวหวานสุโขทัย100% 1000ML  8853333016383   
4         ปลาณีตปลาข้างเหลืองย่างรส รสพริกไทยดำ45G.            NaN   
...                                             ...            ...   
88550                        พวงมาลัยกล้วยไม้ 79บาท            NaN   
88551  BONCHI เอบิ อาเงะเซ็น (ขนมข้าวทอดกรอบรสกุ้ง)  8850358040508   
88552  386372 ชุดกล่องอาหารปลอดสาร BPA 5 ชอ้นแอโรว์            NaN   
88553               ขายทำคืน NEOS PACIFICE AROMATIC         661522   
88554             ALLOWRIE เนยสดเค็มถ้วยเล็ก 10กรัม            NaN   

        pr_barcode2 sort_weight master_online SaleMode_unit ba_nprice  
0      841013411860           0             Y          ITEM    367.00  
1      880107311389           0             Y          ITEM     55.00  
2           2203790           0             N          ITEM    824.00  
3      885333301638           0             Y          ITEM     68.00  
4               NaN         0.0           NaN           NaN       NaN  
...             ...         ...           ...           ...       ...  
88550           NaN         0.0           NaN           NaN       NaN  
88551  885035804050           0             N          ITEM    150.00  
88552           NaN         0.0           NaN           NaN       NaN  
88553         66152           0             N          ITEM    230.00  
88554           NaN         0.0           NaN           NaN       NaN  

[88555 rows x 55 columns]
hashKey is allData-hash
saving hash to s3
saved hash c111d77a566f6529b6e24817eb0fea9c89ae85e8
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="n">ProductDatabase</span><span class="o">.</span><span class="n">allQuery</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>product-bucket-dev-manual
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iprcode</th>
      <th>cprcode</th>
      <th>oprcode</th>
      <th>ordertype</th>
      <th>pr_abb</th>
      <th>pr_active</th>
      <th>pr_cgcode</th>
      <th>pr_code</th>
      <th>pr_dpcode</th>
      <th>pr_engname</th>
      <th>...</th>
      <th>hema_name_en</th>
      <th>hema_name_th</th>
      <th>pr_name_en</th>
      <th>pr_name_th</th>
      <th>pr_barcode</th>
      <th>pr_barcode2</th>
      <th>sort_weight</th>
      <th>master_online</th>
      <th>SaleMode_unit</th>
      <th>ba_nprice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0140942</td>
      <td>0140942</td>
      <td>0140942</td>
      <td>Y</td>
      <td>FRAGATA OLIVE POMACE</td>
      <td>Y</td>
      <td>01</td>
      <td>0140942</td>
      <td>08</td>
      <td>FRAGATA OLIVE POMACE OIL 2 LITE</td>
      <td>...</td>
      <td>Olive Pomace Oil</td>
      <td>Olive Pomace Oil</td>
      <td>FRAGATA OLIVE POMACE OIL 2 LITE</td>
      <td>FRAGATA น้ำมันมะกอกธรรมชาติ-กรรมวิธี 2 ลิตร</td>
      <td>8410134118601</td>
      <td>841013411860</td>
      <td>0</td>
      <td>Y</td>
      <td>ITEM</td>
      <td>367.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0223750</td>
      <td>0223750</td>
      <td>0223750</td>
      <td>Y</td>
      <td>SAMYANG HOT CHICKHEN</td>
      <td>Y</td>
      <td>04</td>
      <td>0223750</td>
      <td>03</td>
      <td>SAMYANG HOT CHICKHEN CARBONARA130G</td>
      <td>...</td>
      <td>Hot Chickhen Carbonarag</td>
      <td>Hot Chickhen Carbonarag</td>
      <td>SAMYANG HOT CHICKHEN CARBONARA130G</td>
      <td>SAMYANG ฮอตชิคเค่น คาโบนาร่า 130กรัม</td>
      <td>8801073113893</td>
      <td>880107311389</td>
      <td>0</td>
      <td>Y</td>
      <td>ITEM</td>
      <td>55.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0203790</td>
      <td>0203790</td>
      <td>0203790</td>
      <td>Y</td>
      <td>KRISTY HAMPER 2016 G</td>
      <td>Y</td>
      <td>45</td>
      <td>0203790</td>
      <td>19</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>...</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>22037909</td>
      <td>2203790</td>
      <td>0</td>
      <td>N</td>
      <td>ITEM</td>
      <td>824.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0207006</td>
      <td>0207006</td>
      <td>0207006</td>
      <td>Y</td>
      <td>MALEE 100%TANGERINE</td>
      <td>Y</td>
      <td>03</td>
      <td>0207006</td>
      <td>20</td>
      <td>MALEE 100%TANGERINE SUKHOTHAI 1000 ML</td>
      <td>...</td>
      <td>100% Tangerine Sukhothai</td>
      <td>100% Tangerine Sukhothai</td>
      <td>MALEE 100%TANGERINE SUKHOTHAI 1000 ML</td>
      <td>มาลี น้ำส้มเขียวหวานสุโขทัย100% 1000ML</td>
      <td>8853333016383</td>
      <td>885333301638</td>
      <td>0</td>
      <td>Y</td>
      <td>ITEM</td>
      <td>68.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>235078</td>
      <td>235078</td>
      <td>235078</td>
      <td>Y</td>
      <td>PLANEAT ROASTED SEAS</td>
      <td>Y</td>
      <td>31</td>
      <td>0235078</td>
      <td>19.0</td>
      <td>PLANEAT ROASTED SEASONED AJI BLACK PEPPE</td>
      <td>...</td>
      <td>PLANEAT ROASTED SEASONED AJI BLACK PEPPE</td>
      <td>PLANEAT ROASTED SEASONED AJI BLACK PEPPE</td>
      <td>PLANEAT ROASTED SEASONED AJI BLACK PEPPE</td>
      <td>ปลาณีตปลาข้างเหลืองย่างรส รสพริกไทยดำ45G.</td>
      <td>None</td>
      <td>None</td>
      <td>0.0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>88550</th>
      <td>222555</td>
      <td>222555</td>
      <td>222555</td>
      <td>Y</td>
      <td>พวงมาลัยกล้วยไม้ 79บ</td>
      <td>Y</td>
      <td>27</td>
      <td>222555</td>
      <td>19.0</td>
      <td>พวงมาลัยกล้วยไม้ 79บาท</td>
      <td>...</td>
      <td>Orchid Garland</td>
      <td>พวงมาลัยกล้วยไม้</td>
      <td>พวงมาลัยกล้วยไม้ 79บาท</td>
      <td>พวงมาลัยกล้วยไม้ 79บาท</td>
      <td>None</td>
      <td>None</td>
      <td>0.0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>88551</th>
      <td>0138956</td>
      <td>0138956</td>
      <td>0138956</td>
      <td>Y</td>
      <td>BONCHI CORP EBI AGES</td>
      <td>Y</td>
      <td>17</td>
      <td>0138956</td>
      <td>19</td>
      <td>BONCHI CORP EBI AGESEN 92G</td>
      <td>...</td>
      <td>BONCHI CORP EBI AGESEN 92G</td>
      <td>BONCHI CORP EBI AGESEN 92G</td>
      <td>BONCHI CORP EBI AGESEN 92G</td>
      <td>BONCHI เอบิ อาเงะเซ็น (ขนมข้าวทอดกรอบรสกุ้ง)</td>
      <td>8850358040508</td>
      <td>885035804050</td>
      <td>0</td>
      <td>N</td>
      <td>ITEM</td>
      <td>150.00</td>
    </tr>
    <tr>
      <th>88552</th>
      <td>222318</td>
      <td>222318</td>
      <td>222318</td>
      <td>Y</td>
      <td>386372 PACK PT FREEE</td>
      <td>Y</td>
      <td>8</td>
      <td>222318</td>
      <td>19.0</td>
      <td>386372 PACK PT FREEEZER STORAGE CONTAINE</td>
      <td>...</td>
      <td>386372 PACK PT FREEEZER STORAGE CONTAINE</td>
      <td>386372 PACK PT FREEEZER STORAGE CONTAINE</td>
      <td>386372 PACK PT FREEEZER STORAGE CONTAINE</td>
      <td>386372 ชุดกล่องอาหารปลอดสาร BPA 5 ชอ้นแอโรว์</td>
      <td>None</td>
      <td>None</td>
      <td>0.0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>88553</th>
      <td>0066152</td>
      <td>0066152</td>
      <td>0066152</td>
      <td>Y</td>
      <td>NEOS  PACIFICE AROMA</td>
      <td>Y</td>
      <td>20</td>
      <td>0066152</td>
      <td>19</td>
      <td>NEOS  PACIFICE AROMATIC</td>
      <td>...</td>
      <td>NEOS  PACIFICE AROMATIC</td>
      <td>NEOS  PACIFICE AROMATIC</td>
      <td>NEOS  PACIFICE AROMATIC</td>
      <td>ขายทำคืน NEOS PACIFICE AROMATIC</td>
      <td>661522</td>
      <td>66152</td>
      <td>0</td>
      <td>N</td>
      <td>ITEM</td>
      <td>230.00</td>
    </tr>
    <tr>
      <th>88554</th>
      <td>184290</td>
      <td>184290</td>
      <td>184290</td>
      <td>Y</td>
      <td>ALLOWRIE BUTTER SALT</td>
      <td>Y</td>
      <td>1</td>
      <td>184290</td>
      <td>13.0</td>
      <td>ALLOWRIE BUTTER SALTED 10 G.</td>
      <td>...</td>
      <td>ALLOWRIE BUTTER SALTED 10 G.</td>
      <td>ALLOWRIE BUTTER SALTED 10 G.</td>
      <td>ALLOWRIE BUTTER SALTED 10 G.</td>
      <td>ALLOWRIE เนยสดเค็มถ้วยเล็ก 10กรัม</td>
      <td>None</td>
      <td>None</td>
      <td>0.0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>88555 rows × 55 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lambdaClearCache" class="doc_header"><code>lambdaClearCache</code><a href="https://github.com/thanakijwanavit/villaProductDatabase/tree/master/villaProductDatabase/database.py#L218" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lambdaClearCache</code>(<strong>*<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lambdaClearCache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>       iprcode  cprcode  oprcode ordertype                pr_abb pr_active  \
0      0140942  0140942  0140942         Y  FRAGATA OLIVE POMACE         Y   
1      0223750  0223750  0223750         Y  SAMYANG HOT CHICKHEN         Y   
2      0203790  0203790  0203790         Y  KRISTY HAMPER 2016 G         Y   
3      0207006  0207006  0207006         Y   MALEE 100%TANGERINE         Y   
4       235078   235078   235078         Y  PLANEAT ROASTED SEAS         Y   
...        ...      ...      ...       ...                   ...       ...   
88550   222555   222555   222555         Y  พวงมาลัยกล้วยไม้ 79บ         Y   
88551  0138956  0138956  0138956         Y  BONCHI CORP EBI AGES         Y   
88552   222318   222318   222318         Y  386372 PACK PT FREEE         Y   
88553  0066152  0066152  0066152         Y  NEOS  PACIFICE AROMA         Y   
88554   184290   184290   184290         Y  ALLOWRIE BUTTER SALT         Y   

      pr_cgcode  pr_code pr_dpcode                                pr_engname  \
0            01  0140942        08           FRAGATA OLIVE POMACE OIL 2 LITE   
1            04  0223750        03        SAMYANG HOT CHICKHEN CARBONARA130G   
2            45  0203790        19                  KRISTY HAMPER 2016 SET G   
3            03  0207006        20     MALEE 100%TANGERINE SUKHOTHAI 1000 ML   
4            31  0235078      19.0  PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...         ...      ...       ...                                       ...   
88550        27   222555      19.0                    พวงมาลัยกล้วยไม้ 79บาท   
88551        17  0138956        19                BONCHI CORP EBI AGESEN 92G   
88552         8   222318      19.0  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553        20  0066152        19                   NEOS  PACIFICE AROMATIC   
88554         1   184290      13.0              ALLOWRIE BUTTER SALTED 10 G.   

       ...                              hema_name_en  \
0      ...                          Olive Pomace Oil   
1      ...                   Hot Chickhen Carbonarag   
2      ...                  KRISTY HAMPER 2016 SET G   
3      ...                  100% Tangerine Sukhothai   
4      ...  PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...    ...                                       ...   
88550  ...                            Orchid Garland   
88551  ...                BONCHI CORP EBI AGESEN 92G   
88552  ...  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553  ...                   NEOS  PACIFICE AROMATIC   
88554  ...              ALLOWRIE BUTTER SALTED 10 G.   

                                   hema_name_th  \
0                              Olive Pomace Oil   
1                       Hot Chickhen Carbonarag   
2                      KRISTY HAMPER 2016 SET G   
3                      100% Tangerine Sukhothai   
4      PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...                                         ...   
88550                          พวงมาลัยกล้วยไม้   
88551                BONCHI CORP EBI AGESEN 92G   
88552  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553                   NEOS  PACIFICE AROMATIC   
88554              ALLOWRIE BUTTER SALTED 10 G.   

                                     pr_name_en  \
0               FRAGATA OLIVE POMACE OIL 2 LITE   
1            SAMYANG HOT CHICKHEN CARBONARA130G   
2                      KRISTY HAMPER 2016 SET G   
3         MALEE 100%TANGERINE SUKHOTHAI 1000 ML   
4      PLANEAT ROASTED SEASONED AJI BLACK PEPPE   
...                                         ...   
88550                    พวงมาลัยกล้วยไม้ 79บาท   
88551                BONCHI CORP EBI AGESEN 92G   
88552  386372 PACK PT FREEEZER STORAGE CONTAINE   
88553                   NEOS  PACIFICE AROMATIC   
88554              ALLOWRIE BUTTER SALTED 10 G.   

                                         pr_name_th     pr_barcode  \
0       FRAGATA น้ำมันมะกอกธรรมชาติ-กรรมวิธี 2 ลิตร  8410134118601   
1              SAMYANG ฮอตชิคเค่น คาโบนาร่า 130กรัม  8801073113893   
2                          KRISTY HAMPER 2016 SET G       22037909   
3            มาลี น้ำส้มเขียวหวานสุโขทัย100% 1000ML  8853333016383   
4         ปลาณีตปลาข้างเหลืองย่างรส รสพริกไทยดำ45G.            NaN   
...                                             ...            ...   
88550                        พวงมาลัยกล้วยไม้ 79บาท            NaN   
88551  BONCHI เอบิ อาเงะเซ็น (ขนมข้าวทอดกรอบรสกุ้ง)  8850358040508   
88552  386372 ชุดกล่องอาหารปลอดสาร BPA 5 ชอ้นแอโรว์            NaN   
88553               ขายทำคืน NEOS PACIFICE AROMATIC         661522   
88554             ALLOWRIE เนยสดเค็มถ้วยเล็ก 10กรัม            NaN   

        pr_barcode2 sort_weight master_online SaleMode_unit ba_nprice  
0      841013411860           0             Y          ITEM    367.00  
1      880107311389           0             Y          ITEM     55.00  
2           2203790           0             N          ITEM    824.00  
3      885333301638           0             Y          ITEM     68.00  
4               NaN         0.0           NaN           NaN       NaN  
...             ...         ...           ...           ...       ...  
88550           NaN         0.0           NaN           NaN       NaN  
88551  885035804050           0             N          ITEM    150.00  
88552           NaN         0.0           NaN           NaN       NaN  
88553         66152           0             N          ITEM    230.00  
88554           NaN         0.0           NaN           NaN       NaN  

[88555 rows x 55 columns]
hashKey is allData-hash
saving hash to s3
saved hash c111d77a566f6529b6e24817eb0fea9c89ae85e8
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;{}&#39;,
 &#39;statusCode&#39;: 200,
 &#39;headers&#39;: {&#39;Access-Control-Allow-Headers&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Methods&#39;: &#39;*&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ProductDatabase</span><span class="o">.</span><span class="n">loadFromCache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading hashkey allData-hash
loaded hash is c111d77a566f6529b6e24817eb0fea9c89ae85e8
data is still in sync, using local cache
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iprcode</th>
      <th>cprcode</th>
      <th>oprcode</th>
      <th>ordertype</th>
      <th>pr_abb</th>
      <th>pr_active</th>
      <th>pr_cgcode</th>
      <th>pr_code</th>
      <th>pr_dpcode</th>
      <th>pr_engname</th>
      <th>...</th>
      <th>hema_name_en</th>
      <th>hema_name_th</th>
      <th>pr_name_en</th>
      <th>pr_name_th</th>
      <th>pr_barcode</th>
      <th>pr_barcode2</th>
      <th>sort_weight</th>
      <th>master_online</th>
      <th>SaleMode_unit</th>
      <th>ba_nprice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0140942</td>
      <td>0140942</td>
      <td>0140942</td>
      <td>Y</td>
      <td>FRAGATA OLIVE POMACE</td>
      <td>Y</td>
      <td>01</td>
      <td>0140942</td>
      <td>08</td>
      <td>FRAGATA OLIVE POMACE OIL 2 LITE</td>
      <td>...</td>
      <td>Olive Pomace Oil</td>
      <td>Olive Pomace Oil</td>
      <td>FRAGATA OLIVE POMACE OIL 2 LITE</td>
      <td>FRAGATA น้ำมันมะกอกธรรมชาติ-กรรมวิธี 2 ลิตร</td>
      <td>8410134118601</td>
      <td>841013411860</td>
      <td>0</td>
      <td>Y</td>
      <td>ITEM</td>
      <td>367.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0223750</td>
      <td>0223750</td>
      <td>0223750</td>
      <td>Y</td>
      <td>SAMYANG HOT CHICKHEN</td>
      <td>Y</td>
      <td>04</td>
      <td>0223750</td>
      <td>03</td>
      <td>SAMYANG HOT CHICKHEN CARBONARA130G</td>
      <td>...</td>
      <td>Hot Chickhen Carbonarag</td>
      <td>Hot Chickhen Carbonarag</td>
      <td>SAMYANG HOT CHICKHEN CARBONARA130G</td>
      <td>SAMYANG ฮอตชิคเค่น คาโบนาร่า 130กรัม</td>
      <td>8801073113893</td>
      <td>880107311389</td>
      <td>0</td>
      <td>Y</td>
      <td>ITEM</td>
      <td>55.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0203790</td>
      <td>0203790</td>
      <td>0203790</td>
      <td>Y</td>
      <td>KRISTY HAMPER 2016 G</td>
      <td>Y</td>
      <td>45</td>
      <td>0203790</td>
      <td>19</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>...</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>KRISTY HAMPER 2016 SET G</td>
      <td>22037909</td>
      <td>2203790</td>
      <td>0</td>
      <td>N</td>
      <td>ITEM</td>
      <td>824.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0207006</td>
      <td>0207006</td>
      <td>0207006</td>
      <td>Y</td>
      <td>MALEE 100%TANGERINE</td>
      <td>Y</td>
      <td>03</td>
      <td>0207006</td>
      <td>20</td>
      <td>MALEE 100%TANGERINE SUKHOTHAI 1000 ML</td>
      <td>...</td>
      <td>100% Tangerine Sukhothai</td>
      <td>100% Tangerine Sukhothai</td>
      <td>MALEE 100%TANGERINE SUKHOTHAI 1000 ML</td>
      <td>มาลี น้ำส้มเขียวหวานสุโขทัย100% 1000ML</td>
      <td>8853333016383</td>
      <td>885333301638</td>
      <td>0</td>
      <td>Y</td>
      <td>ITEM</td>
      <td>68.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>235078</td>
      <td>235078</td>
      <td>235078</td>
      <td>Y</td>
      <td>PLANEAT ROASTED SEAS</td>
      <td>Y</td>
      <td>31</td>
      <td>0235078</td>
      <td>19.0</td>
      <td>PLANEAT ROASTED SEASONED AJI BLACK PEPPE</td>
      <td>...</td>
      <td>PLANEAT ROASTED SEASONED AJI BLACK PEPPE</td>
      <td>PLANEAT ROASTED SEASONED AJI BLACK PEPPE</td>
      <td>PLANEAT ROASTED SEASONED AJI BLACK PEPPE</td>
      <td>ปลาณีตปลาข้างเหลืองย่างรส รสพริกไทยดำ45G.</td>
      <td>None</td>
      <td>None</td>
      <td>0.0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>88550</th>
      <td>222555</td>
      <td>222555</td>
      <td>222555</td>
      <td>Y</td>
      <td>พวงมาลัยกล้วยไม้ 79บ</td>
      <td>Y</td>
      <td>27</td>
      <td>222555</td>
      <td>19.0</td>
      <td>พวงมาลัยกล้วยไม้ 79บาท</td>
      <td>...</td>
      <td>Orchid Garland</td>
      <td>พวงมาลัยกล้วยไม้</td>
      <td>พวงมาลัยกล้วยไม้ 79บาท</td>
      <td>พวงมาลัยกล้วยไม้ 79บาท</td>
      <td>None</td>
      <td>None</td>
      <td>0.0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>88551</th>
      <td>0138956</td>
      <td>0138956</td>
      <td>0138956</td>
      <td>Y</td>
      <td>BONCHI CORP EBI AGES</td>
      <td>Y</td>
      <td>17</td>
      <td>0138956</td>
      <td>19</td>
      <td>BONCHI CORP EBI AGESEN 92G</td>
      <td>...</td>
      <td>BONCHI CORP EBI AGESEN 92G</td>
      <td>BONCHI CORP EBI AGESEN 92G</td>
      <td>BONCHI CORP EBI AGESEN 92G</td>
      <td>BONCHI เอบิ อาเงะเซ็น (ขนมข้าวทอดกรอบรสกุ้ง)</td>
      <td>8850358040508</td>
      <td>885035804050</td>
      <td>0</td>
      <td>N</td>
      <td>ITEM</td>
      <td>150.00</td>
    </tr>
    <tr>
      <th>88552</th>
      <td>222318</td>
      <td>222318</td>
      <td>222318</td>
      <td>Y</td>
      <td>386372 PACK PT FREEE</td>
      <td>Y</td>
      <td>8</td>
      <td>222318</td>
      <td>19.0</td>
      <td>386372 PACK PT FREEEZER STORAGE CONTAINE</td>
      <td>...</td>
      <td>386372 PACK PT FREEEZER STORAGE CONTAINE</td>
      <td>386372 PACK PT FREEEZER STORAGE CONTAINE</td>
      <td>386372 PACK PT FREEEZER STORAGE CONTAINE</td>
      <td>386372 ชุดกล่องอาหารปลอดสาร BPA 5 ชอ้นแอโรว์</td>
      <td>None</td>
      <td>None</td>
      <td>0.0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>88553</th>
      <td>0066152</td>
      <td>0066152</td>
      <td>0066152</td>
      <td>Y</td>
      <td>NEOS  PACIFICE AROMA</td>
      <td>Y</td>
      <td>20</td>
      <td>0066152</td>
      <td>19</td>
      <td>NEOS  PACIFICE AROMATIC</td>
      <td>...</td>
      <td>NEOS  PACIFICE AROMATIC</td>
      <td>NEOS  PACIFICE AROMATIC</td>
      <td>NEOS  PACIFICE AROMATIC</td>
      <td>ขายทำคืน NEOS PACIFICE AROMATIC</td>
      <td>661522</td>
      <td>66152</td>
      <td>0</td>
      <td>N</td>
      <td>ITEM</td>
      <td>230.00</td>
    </tr>
    <tr>
      <th>88554</th>
      <td>184290</td>
      <td>184290</td>
      <td>184290</td>
      <td>Y</td>
      <td>ALLOWRIE BUTTER SALT</td>
      <td>Y</td>
      <td>1</td>
      <td>184290</td>
      <td>13.0</td>
      <td>ALLOWRIE BUTTER SALTED 10 G.</td>
      <td>...</td>
      <td>ALLOWRIE BUTTER SALTED 10 G.</td>
      <td>ALLOWRIE BUTTER SALTED 10 G.</td>
      <td>ALLOWRIE BUTTER SALTED 10 G.</td>
      <td>ALLOWRIE เนยสดเค็มถ้วยเล็ก 10กรัม</td>
      <td>None</td>
      <td>None</td>
      <td>0.0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>88555 rows × 55 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

